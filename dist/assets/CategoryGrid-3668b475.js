import{r as o,j as r}from"./index-75deb616.js";import{f as E}from"./tmdb-dd13b212.js";import{M as S}from"./MovieCard-deef116b.js";import{M as w}from"./Skeleton-60dc65eb.js";import{u as _}from"./useKeyboardNavigation-f198f7fd.js";function W({title:p,category:i,type:n,genreId:c}){const[v,f]=o.useState([]),[x,g]=o.useState(!0),[a,j]=o.useState(1),[d,h]=o.useState(!0),u=o.useRef(null);_(u,".movie-card");function M(e){const s=`${e.title||""} ${e.original_title||""} ${e.overview||""}`.toLowerCase();return!e.adult&&e.poster_path&&!["porn","pornographic","erotic","fetish","hardcore","sex","sexual","nude","naked","xvideo","xhamster","zwinger","escort","adult video","strip","lust","야동","야사","에로","성인","노출","19금","음란","포르노","섹스","불륜","エロ","レイプ","アダルト","爆乳","セックス"].some(t=>s.includes(t))}return o.useEffect(()=>{j(1),f([]),h(!0)},[i,n,c]),o.useEffect(()=>{async function e(){if(!(!d&&a>1))try{let s="";if(i&&n?s=`/${n}/${i}?language=ko-KR&page=${a}&include_adult=false`:c&&(s=`/discover/movie?with_genres=${c}&language=ko-KR&page=${a}&include_adult=false`),!s)return;g(a===1);const t=await E(s),l=(t.results||[]).filter(M);f(a===1?l:m=>[...m,...l]),h(t.results&&t.results.length>0&&l.length>0)}catch(s){console.error("CategoryGrid fetch error:",s),h(!1)}finally{g(!1)}}e()},[a,i,n,c,d]),o.useEffect(()=>{var t;const e=(t=u.current)==null?void 0:t.closest(".scroll-wrapper");if(!e||!d)return;const s=()=>{const{scrollLeft:l,scrollWidth:m,clientWidth:$}=e,N=200;m-l-$<N&&j(C=>C+1)};return e.addEventListener("scroll",s),()=>e.removeEventListener("scroll",s)},[d]),r.jsxs("div",{className:"category-grid",children:[p&&r.jsx("h2",{className:"category-title",children:p}),x?r.jsx("div",{className:"scroll-wrapper",children:r.jsx("div",{className:"movie-row",ref:u,children:[...Array(6)].map((e,s)=>r.jsx(w,{},s))})}):v.length>0?r.jsx("div",{className:"scroll-wrapper",children:r.jsxs("div",{className:"movie-row fade-in",ref:u,children:[v.map(e=>r.jsx(S,{movie:e},e.id)),x&&a>1&&r.jsx(r.Fragment,{children:[...Array(3)].map((e,s)=>r.jsx(w,{},`loading-${s}`))})]})}):r.jsx("p",{className:"no-results",children:"영화가 없습니다."})]})}export{W as C};
