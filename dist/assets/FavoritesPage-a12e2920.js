import{d as z,f as M,y as T,r as n,j as e,z as $,A,B}from"./index-75deb616.js";import{M as I}from"./MovieCard-deef116b.js";import{M as E}from"./Skeleton-60dc65eb.js";/* empty css               */const L=[{value:"recent",label:"최근 추가순"},{value:"title",label:"제목순"},{value:"rating",label:"평점순"}];function q(){const{user:j}=z(),{favorites:r,toggleFavorite:g,loading:p}=M(),{success:b,error:N}=T(),[l,h]=n.useState("all"),[m,S]=n.useState("recent"),[i,c]=n.useState(new Set),[f,u]=n.useState(!1),[w,x]=n.useState(!1),d=n.useMemo(()=>{const s=r.filter(a=>a.media_type?a.media_type==="movie":!a.name),t=r.filter(a=>a.media_type?a.media_type==="tv":!!a.name);return{movies:s,tvs:t}},[r]),o=n.useMemo(()=>{let s=[];l==="movie"?s=d.movies:l==="tv"?s=d.tvs:s=r;const t=[...s];switch(m){case"title":t.sort((a,v)=>{const F=(a.title||a.name||"").toLowerCase(),_=(v.title||v.name||"").toLowerCase();return F.localeCompare(_,"ko")});break;case"rating":t.sort((a,v)=>(v.vote_average||0)-(a.vote_average||0));break}return t},[r,l,m,d]),y=s=>{const t=new Set(i);t.has(s)?t.delete(s):t.add(s),c(t)},k=()=>{i.size===o.length?c(new Set):c(new Set(o.map(s=>s.id)))},C=async()=>{if(i.size===0){showInfo("삭제할 항목을 선택해주세요.");return}if(window.confirm(`선택한 ${i.size}개 항목을 삭제하시겠습니까?`)){x(!0);try{for(const s of i){const t=r.find(a=>a.id===s);t&&await g(t)}c(new Set),u(!1),b(`${i.size}개 항목이 삭제되었습니다.`)}catch(s){console.error("삭제 오류:",s),N("삭제 중 오류가 발생했습니다.")}finally{x(!1)}}};return j?e.jsxs("div",{className:"favorites-page fade-in",children:[e.jsxs("div",{className:"favorites-header",children:[e.jsx("h1",{className:"favorites-title",children:"내 찜 목록"}),e.jsx("div",{className:"favorites-actions",children:o.length>0&&e.jsx(e.Fragment,{children:f?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"favorites-action-btn",onClick:k,children:i.size===o.length?"전체 해제":"전체 선택"}),e.jsxs("button",{className:"favorites-action-btn delete-btn",onClick:C,disabled:i.size===0||w,children:[e.jsx(A,{})," 삭제 (",i.size,")"]}),e.jsx("button",{className:"favorites-action-btn",onClick:()=>{u(!1),c(new Set)},children:"취소"})]}):e.jsxs("button",{className:"favorites-action-btn",onClick:()=>u(!0),title:"선택 모드",children:[e.jsx($,{})," 선택"]})})})]}),r.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"favorites-tabs",children:[e.jsxs("button",{className:`favorites-tab ${l==="all"?"active":""}`,onClick:()=>h("all"),children:["전체 (",r.length,")"]}),e.jsxs("button",{className:`favorites-tab ${l==="movie"?"active":""}`,onClick:()=>h("movie"),children:["영화 (",d.movies.length,")"]}),e.jsxs("button",{className:`favorites-tab ${l==="tv"?"active":""}`,onClick:()=>h("tv"),children:["드라마 (",d.tvs.length,")"]})]}),e.jsxs("div",{className:"favorites-controls",children:[e.jsxs("div",{className:"favorites-sort",children:[e.jsx(B,{className:"sort-icon"}),e.jsx("select",{className:"sort-select",value:m,onChange:s=>S(s.target.value),children:L.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{className:"favorites-count",children:["총 ",o.length,"개"]})]})]}),p?e.jsx("div",{className:"favorites-grid",children:[...Array(12)].map((s,t)=>e.jsx(E,{},t))}):o.length>0?e.jsx("div",{className:"favorites-grid",children:o.map(s=>e.jsxs("div",{className:`favorites-card-wrapper ${f?"select-mode":""} ${i.has(s.id)?"selected":""}`,children:[f&&e.jsx("div",{className:"favorites-checkbox",children:e.jsx("input",{type:"checkbox",checked:i.has(s.id),onChange:()=>y(s.id)})}),e.jsx(I,{movie:{...s,media_type:s.media_type||(s.name?"tv":"movie")}})]},s.id))}):e.jsxs("div",{className:"favorites-empty-state",children:[e.jsx("div",{className:"empty-icon",children:"❤️"}),e.jsx("h2",{children:l==="movie"?"찜한 영화가 없습니다":l==="tv"?"찜한 드라마가 없습니다":"아직 찜한 콘텐츠가 없습니다"}),e.jsx("p",{children:"마음에 드는 영화나 드라마를 찜해보세요!"})]})]}):e.jsx("div",{className:"favorites-page",children:e.jsxs("div",{className:"favorites-empty-state",children:[e.jsx("h2",{children:"로그인이 필요합니다"}),e.jsx("p",{children:"찜 목록을 보려면 로그인해주세요."})]})})}export{q as default};
