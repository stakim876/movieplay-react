import{X as N,y as S,r as a,j as s,E as C}from"./index-75deb616.js";import{f as H}from"./tmdb-dd13b212.js";import{M as P}from"./MovieCard-deef116b.js";import{M as E}from"./Skeleton-60dc65eb.js";import{u as R}from"./useKeyboardNavigation-f198f7fd.js";/* empty css               */function z(){const{type:i,category:n,genreId:c}=N(),{error:y}=S(),[f,m]=a.useState([]),[l,w]=a.useState(!0),[o,h]=a.useState(1),[d,u]=a.useState(!0),[p,j]=a.useState(null),v=a.useRef(null);R(v,".movie-card");function M(e){const r=`${e.title||e.name||""} ${e.overview||""}`.toLowerCase();return!e.adult&&!["porn","pornographic","zwinger","erotic","fetish","xvideo","xhamster","adult video","hardcore","nude","야동","에로","성인","노출","19금","음란","포르노"].some(t=>r.includes(t))}a.useEffect(()=>{h(1),m([]),u(!0)},[i,n,c]),a.useEffect(()=>{async function e(){if(!(!d&&o>1))try{let r="";if(i&&n?r=`/${i}/${n}?language=ko-KR&page=${o}`:c&&(r=`/discover/movie?with_genres=${c}&language=ko-KR&page=${o}`),!r)return;w(o===1);const t=await H(r),g=(t.results||[]).filter(M);m(o===1?g:x=>[...x,...g]),u(t.results&&t.results.length>0&&g.length>0)}catch(r){console.error("CategoryPage fetch error:",r);const t=r.message||"콘텐츠를 불러오는데 실패했습니다.";j(t),u(!1),o===1&&y(t)}finally{w(!1)}}e()},[o,i,n,c,d,y]),a.useEffect(()=>{const e=()=>{const t=window.innerHeight+window.scrollY;document.documentElement.scrollHeight-t<500&&d&&!l&&h(x=>x+1)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[d,l]);const $=i&&n?`${i==="movie"?"영화":"드라마"} - ${{popular:"인기작",now_playing:"현재 상영작",top_rated:"평점 높은 작품",upcoming:"개봉 예정작"}[n]||n}`:"장르별 영화";return s.jsx(C,{showDetails:!1,children:s.jsxs("div",{className:"category-page",children:[s.jsx("h2",{className:"page-title",children:$}),p&&f.length===0&&!l&&s.jsxs("div",{className:"error-state",children:[s.jsx("p",{className:"error-message",children:p}),s.jsx("button",{className:"retry-btn",onClick:()=>{h(1),j(null),u(!0)},children:"다시 시도"})]}),l&&o===1?s.jsx("div",{className:"movie-grid",ref:v,children:[...Array(10)].map((e,r)=>s.jsx(E,{},r))}):f.length>0?s.jsxs("div",{className:"movie-grid fade-in",ref:v,children:[f.map(e=>s.jsx(P,{movie:e},e.id)),l&&o>1&&s.jsx(s.Fragment,{children:[...Array(6)].map((e,r)=>s.jsx(E,{},`loading-${r}`))})]}):p?null:s.jsx("p",{className:"no-results",children:"콘텐츠가 없습니다."})]})})}export{z as default};
